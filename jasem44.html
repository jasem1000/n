1
// Models/Patient.cs
using System;
using System.ComponentModel.DataAnnotations;

public class Patient
{
    [Key] // يحدد هذا الحقل كمفتاح أساسي للجدول
    public int Id { get; set; }

    [Required] // الحقل مطلوب
    public string MedicalId { get; set; } // الرقم الطبي

    [Required]
    public string FullName { get; set; } // الاسم الكامل

    public DateTime DateOfBirth { get; set; } // تاريخ الميلاد

    public string Gender { get; set; } // الجنس (ذكر/أنثى)

    public string PhoneNumber { get; set; } // رقم الهاتف
}
2LabTest.cs
// Models/LabTest.cs
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

public class LabTest
{
    [Key]
    public int Id { get; set; }

    [Required]
    public string TestName { get; set; } // اسم الفحص

    public string Category { get; set; } // فئة الفحص (e.g., كيمياء, هرمونات)

    [Column(TypeName = "decimal(18, 2)")] // تحديد نوع البيانات في قاعدة البيانات
    public decimal Price { get; set; } // سعر الفحص

    public string NormalRange { get; set; } // القيم المرجعية
}

3ApplicationDbContext.cs
// Data/ApplicationDbContext.cs
using Microsoft.EntityFrameworkCore;
using System.IO;
using System;

public class ApplicationDbContext : DbContext
{
    // تحديد الجداول في قاعدة البيانات
    public DbSet<Patient> Patients { get; set; }
    public DbSet<LabTest> LabTests { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        // تحديد مسار قاعدة البيانات ليكون في نفس مجلد البرنامج
        string dbPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "MedicalLab.db");
        // استخدام SQLite وتحديد مسار الملف
        optionsBuilder.UseSqlite($"Data Source={dbPath}");
    }
}

        4Add-Migration InitialCreate
Update-Database
ViewModelBase.cs
   // ViewModels/Base/ViewModelBase.cs
using System.ComponentModel;
using System.Runtime.CompilerServices;

public abstract class ViewModelBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
    {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
}
     RelayCommand.cs
        // ViewModels/Base/RelayCommand.cs
using System;
using System.Windows.Input;

public class RelayCommand : ICommand
{
    private readonly Action<object> _execute;
    private readonly Func<object, bool> _canExecute;

    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    public RelayCommand(Action<object> execute, Func<object, bool> canExecute = null)
    {
        _execute = execute ?? throw new ArgumentNullException(nameof(execute));
        _canExecute = canExecute;
    }

    public bool CanExecute(object parameter) => _canExecute == null || _canExecute(parameter);

    public void Execute(object parameter) => _execute(parameter);
}
PatientViewModel.cs
        // ViewModels/PatientViewModel.cs
using System.Collections.ObjectModel;
using System.Linq;
using System.Windows;
using ViewModels.Base; // استدعاء المجلد الأساسي

public class PatientViewModel : ViewModelBase
{
    private readonly ApplicationDbContext _context = new ApplicationDbContext();

    // خاصية لتخزين قائمة المرضى وعرضها في الواجهة
    private ObservableCollection<Patient> _patients;
    public ObservableCollection<Patient> Patients
    {
        get { return _patients; }
        set { _patients = value; OnPropertyChanged(); }
    }

    // خصائص لربطها بحقول إدخال بيانات المريض الجديد
    private string _medicalId;
    public string MedicalId { get => _medicalId; set { _medicalId = value; OnPropertyChanged(); } }

    private string _fullName;
    public string FullName { get => _fullName; set { _fullName = value; OnPropertyChanged(); } }

    // الأوامر التي سيتم ربطها بالأزرار
    public RelayCommand AddPatientCommand { get; }

    public PatientViewModel()
    {
        // تحميل المرضى عند بدء التشغيل
        LoadPatients();
        // ربط الأمر بالدالة التي ستنفذه
        AddPatientCommand = new RelayCommand(AddPatient, CanAddPatient);
    }

    private void LoadPatients()
    {
        var patientList = _context.Patients.ToList();
        Patients = new ObservableCollection<Patient>(patientList);
    }

    private void AddPatient(object parameter)
    {
        var newPatient = new Patient
        {
            MedicalId = this.MedicalId,
            FullName = this.FullName,
            DateOfBirth = System.DateTime.Now, // للتسهيل، يمكن استبدالها بـ DatePicker
            Gender = "N/A"
        };

        _context.Patients.Add(newPatient);
        _context.SaveChanges();

        // تحديث القائمة في الواجهة
        Patients.Add(newPatient);
        MessageBox.Show("تمت إضافة المريض بنجاح!");
    }

    // دالة لتحديد ما إذا كان يمكن تنفيذ الأمر (مثلاً، الحقول ليست فارغة)
    private bool CanAddPatient(object parameter)
    {
        return !string.IsNullOrWhiteSpace(MedicalId) && !string.IsNullOrWhiteSpace(FullName);
    }
}
PatientView.xaml
            <UserControl x:Class="MedicalLabManager.Views.PatientView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MedicalLabManager.Views"
             xmlns:vm="clr-namespace:MedicalLabManager.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800"
             FontFamily="Segoe UI">
    
    <UserControl.DataContext>
        <vm:PatientViewModel/>
    </UserControl.DataContext>
    
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
            <DataGrid ItemsSource="{Binding Patients}" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="الرقم الطبي" Binding="{Binding MedicalId}" Width="*"/>
                    <DataGridTextColumn Header="اسم المريض" Binding="{Binding FullName}" Width="2*"/>
                    <DataGridTextColumn Header="تاريخ الميلاد" Binding="{Binding DateOfBirth, StringFormat='dd/MM/yyyy'}" Width="*"/>
                    <DataGridTextColumn Header="الجنس" Binding="{Binding Gender}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <StackPanel Grid.Column="1" Margin="10,0,0,0">
            <TextBlock Text="إضافة مريض جديد" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

            <TextBlock Text="الرقم الطبي:" Margin="0,5,0,2"/>
            <TextBox Text="{Binding MedicalId, UpdateSourceTrigger=PropertyChanged}" Padding="5"/>

            <TextBlock Text="الاسم الكامل:" Margin="0,10,0,2"/>
            <TextBox Text="{Binding FullName, UpdateSourceTrigger=PropertyChanged}" Padding="5"/>

            <Button Content="إضافة المريض" Command="{Binding AddPatientCommand}" Margin="0,20,0,0" Padding="10,5" Background="DodgerBlue" Foreground="White"/>
        </StackPanel>
    </Grid>
</UserControl>
MainWindow.xaml
                <Window x:Class="MedicalLabManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MedicalLabManager"
        xmlns:views="clr-namespace:MedicalLabManager.Views"
        mc:Ignorable="d"
        Title="برنامج إدارة المختبر الطبي" Height="600" Width="900" WindowStartupLocation="CenterScreen">
    <Grid>
        <TabControl>
            <TabItem Header="إدارة المرضى">
                <views:PatientView/>
            </TabItem>
            <TabItem Header="إدارة الفحوصات">
                <TextBlock Text="واجهة إدارة الفحوصات ستكون هنا." HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="20"/>
            </TabItem>
            <TabItem Header="التقارير">
                </TabItem>
        </TabControl>
    </Grid>
</Window>

                
